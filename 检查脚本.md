#!/bin/bash

echo "ğŸ” å¼€å§‹æ£€æŸ¥å‰ç«¯é¢è¯•é¢˜åº“ä¸­çš„é¢è¯•é¢˜æ–‡ä»¶..."
echo ""

# å®šä¹‰åŒ…å«é¢˜ç›®å’Œç­”æ¡ˆçš„æ–‡ä»¶
declare -a files_to_check=(
    "./å­—èŠ‚è·³åŠ¨-å‰ç«¯é¢è¯•/çœŸé¢˜åˆé›†.md"
    "./å­—èŠ‚è·³åŠ¨-å‰ç«¯é¢è¯•/æ‰‹å†™é˜²æŠ–.md"
    "./å­—èŠ‚è·³åŠ¨-å‰ç«¯é¢è¯•/æœç´¢æ¡†è¯·æ±‚å¤„ç†.md"
    "./å­—èŠ‚è·³åŠ¨/ç¼–ç¨‹é¢˜ä¸“é¡¹/é˜²æŠ–å‡½æ•°å®ç°.md"
    "./å­—èŠ‚è·³åŠ¨ä¸€é¢é«˜é¢‘é¢˜/HTTPSåŠ å¯†ä¸æ•°å­—è¯ä¹¦.md"
    "./å­—èŠ‚è·³åŠ¨/å‰ç«¯é¢è¯•/README.md"
)

# æ£€æŸ¥ç»“æœ
declare -a files_with_questions_only
declare -a files_with_complete_answers
declare -a files_no_questions
declare -a files_with_missing_answers

echo "ğŸ“‹ æ£€æŸ¥é¢è¯•é¢˜æ–‡ä»¶..."
echo ""

for file in "${files_to_check[@]}"; do
    echo "æ£€æŸ¥æ–‡ä»¶: $file"
    
    if [ -f "$file" ]; then
        # æ£€æŸ¥æ˜¯å¦åŒ…å«é¢˜ç›®
        if grep -q "## ğŸ“é¢˜" "$file" > /dev/null; then
            # æ£€æŸ¥æ˜¯å¦æœ‰ç­”æ¡ˆ
            if grep -q "## ğŸ’¡å‚è€ƒç­”æ¡ˆ\|## ğŸ’¡ å‚è€ƒç­”æ¡ˆ\|## ğŸ“ ç­”æ¡ˆ" "$file" > /dev/null; then
                echo "  âœ… æœ‰é¢˜ç›®æœ‰ç­”æ¡ˆ"
                files_with_complete_answers+=("$file")
            else
                echo "  âš ï¸ åªæœ‰é—®é¢˜ï¼Œæ²¡æœ‰ç­”æ¡ˆ"
                files_with_questions_only+=("$file")
            fi
        else
            echo "  â„¹ï¸ï¸ æ²¡æœ‰é¢˜ç›®"
            files_no_questions+=("$file")
        fi
    else
        echo "  âŒ æ–‡ä»¶ä¸å­˜åœ¨"
    fi
    echo ""
done

echo ""
echo "ğŸ“Š æ£€æŸ¥ç»“æœæ±‡æ€»"
echo "======================================="
echo ""
echo "âœ… æœ‰é¢˜ç›®æœ‰ç­”æ¡ˆçš„æ–‡ä»¶æ•°ï¼š${#files_with_complete_answers[@]}"
echo "âš ï¸ åªæœ‰é—®é¢˜æ²¡æœ‰ç­”æ¡ˆçš„æ–‡ä»¶æ•°ï¼š${#files_with_questions_only[@]}"
echo "â„¹ï¸ï¸ æ²¡æœ‰é¢˜ç›®çš„æ–‡ä»¶æ•°ï¼š${#files_no_questions[@]}"
echo "âœ… æ€»å…±æ£€æŸ¥æ–‡ä»¶æ•°ï¼š${#files_to_check[@]}"
echo ""

if [ ${#files_with_questions_only[@]} -eq 0 ]; then
    echo ""
    echo "ğŸ‰ å¥½å¥½ï¼æ‰€æœ‰é¢è¯•é¢˜éƒ½å·²ç»æœ‰å®Œæ•´çš„ç­”æ¡ˆäº†ï¼"
    echo ""
    echo "å¯ä»¥å¼€å§‹æäº¤åˆ° GitHub äº†..."
else
    echo ""
    echo "âš ï¸ å‘ç° ${#files_with_questions_only[@]} ä¸ªæ–‡ä»¶åªæœ‰é—®é¢˜æ²¡æœ‰ç­”æ¡ˆï¼š"
    echo ""
    for file in "${files_with_questions_only[@]}"; do
        echo "  - $file"
    done
    echo ""
    echo "éœ€è¦ä½¿ç”¨ browser å·¥å…·åœ¨è°·æ­Œæœç´¢è¿™äº›é¢˜ç›®çš„ç­”æ¡ˆ..."
fi